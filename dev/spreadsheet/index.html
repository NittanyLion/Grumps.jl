<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Spreadsheet formats · Grumps.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">Grumps.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../installation/">Installation</a></li><li><a class="tocitem" href="../estimators/">Estimators</a></li><li><a class="tocitem" href="../quickstart/">Quick start</a></li><li><a class="tocitem" href="../objects/">User interface</a></li><li class="is-active"><a class="tocitem" href>Spreadsheet formats</a><ul class="internal"><li><a class="tocitem" href="#Linking-between-spreadsheets"><span>Linking between spreadsheets</span></a></li><li><a class="tocitem" href="#Product-characteristics"><span>Product characteristics</span></a></li><li><a class="tocitem" href="#Consumer-characteristics"><span>Consumer characteristics</span></a></li><li><a class="tocitem" href="#Market-sizes"><span>Market sizes</span></a></li><li><a class="tocitem" href="#Draws"><span>Draws</span></a></li></ul></li><li><a class="tocitem" href="../example/">Example program</a></li><li><a class="tocitem" href="../tutorial/">Charlie&#39;s tutorial</a></li><li><a class="tocitem" href="../speedmemory/">Speed, memory, accuracy</a></li><li><a class="tocitem" href="../bearinmind/">Things to bear in mind</a></li><li><a class="tocitem" href="../extending/">Extending Grumps</a></li><li><a class="tocitem" href="../aliens/">Languages other than Julia</a></li><li><a class="tocitem" href="../structure/">Directory structure</a></li><li><a class="tocitem" href="../flow/">Algorithm flow</a></li><li><a class="tocitem" href="../misc/">Miscellanea</a></li><li><a class="tocitem" href="../acknowledgments/">Acknowledgments</a></li><li><a class="tocitem" href="../license/">License</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Spreadsheet formats</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Spreadsheet formats</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/NittanyLion/Grumps.jl/blob/main/docs/src/spreadsheet.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Spreadsheet-formats"><a class="docs-heading-anchor" href="#Spreadsheet-formats">Spreadsheet formats</a><a id="Spreadsheet-formats-1"></a><a class="docs-heading-anchor-permalink" href="#Spreadsheet-formats" title="Permalink"></a></h1><p>Recall that Grumps can take data from four different sources and in different formats.  Currently, only <em>CSV files</em> and <em>DataFrames</em> are implemented.  Recall that not all four sources are required for all estimators.  </p><div class="admonition is-success"><header class="admonition-header">Files are preferable to dataframes</header><div class="admonition-body"><p>There is one advantage to providing file names instead of dataframes, and that is that Julia can release the memory allocated by the memory after return of the <a href="../objects/#Grumps.Data-Tuple{}"><code>Data()</code></a> call.</p></div></div><p>As mentioned elsewhere, there is one spreadsheet (the <em>products</em> spreadsheet) that contains data on products, including e.g. price, market share, features, product level instruments (<span>$s,x,b$</span> in the paper).  If consumer choice data are used then such data can be entered via the <em>consumers</em> spreadsheet, which includes data on individual consumer choices, demographic characteristics, etcetera: anything that would typically have an <span>$i$</span> subscript in other words (<span>$y,z$</span> in the paper).  A <em>market size</em> spreadsheet would contain information on the size of each market, i.e. the population in that market, which is only needed if the macro portion of the likelihood is to be used (<span>$N$</span> in the paper).  Finally, a <em>demographic draws</em> spreadsheet can be provided to be used in the macro likelihood portion of the objective function, i.e. <span>$z$</span> draws to use in the macro integration.  The format of each of these spreadsheets is described below.</p><p>In the examples below, the data are comma separated, but that is not necessary: other formats can be specified in the <a href="../objects/#Grumps.Sources-Tuple{}"><code>Sources()</code></a> call.  Column ordering is irrelevant.</p><div class="admonition is-warning"><header class="admonition-header">Cases and spaces</header><div class="admonition-body"><p>For all spreadsheets be mindful of case and spaces.  That means omit spaces and be consistent in lower case versus upper case. For readability the spreadsheets below contain extra space i.e. they are aligned by comma; this is not advisable.  </p></div></div><h2 id="Linking-between-spreadsheets"><a class="docs-heading-anchor" href="#Linking-between-spreadsheets">Linking between spreadsheets</a><a id="Linking-between-spreadsheets-1"></a><a class="docs-heading-anchor-permalink" href="#Linking-between-spreadsheets" title="Permalink"></a></h2><p>Grumps is flexible in naming conventions.  However, this requires that certain identifiers are common across spreadsheets. The following conventions should hold:</p><ul><li>A market level identifier should be present in all spreadsheets using the same column heading. In the example below, this column heading is <code>market</code>. </li><li>The values of the <code>market</code> column in the marketsize spreadsheet should be unique. These values should link to the <code>market</code> columns in the <em>product</em>, <em>consumer</em>, and <em>draws</em> datasets.</li><li>The values of one column of the <em>product</em> dataset should be a unique identifier of a product within a market. In the example below, the heading for this column is <code>product</code>. </li><li>The values of one column in the <em>consumer</em> dataset should link to the unique identifier column of the <em>product</em> dataset. In the example below, the heading for this column is <code>choice</code>. </li><li>Any variables used as demographics (<span>$z$</span>) should be present in both the <em>consumer</em> and <em>draws</em> datasets using identical column headings.  </li></ul><h2 id="Product-characteristics"><a class="docs-heading-anchor" href="#Product-characteristics">Product characteristics</a><a id="Product-characteristics-1"></a><a class="docs-heading-anchor-permalink" href="#Product-characteristics" title="Permalink"></a></h2><p>Below are the first few lines of a CSV file.  </p><pre><code class="nohighlight hljs">ibu ,  abv, share, IVgh_ibu, IVgh_abv, IVj_ibu, IVj_abv, market  , product
1.09, 1.01, 0.01 , 12.57   , 11.45   , 4.78   , 5.09   , market 1, product 1
2.85,-0.10, 0.13 , 10.52   ,  8.55   , 5.21   , 5.23   , market 1, product 2
2.31, 0.55, 0.02 , 4.54    ,  7.26   , 5.91   , 5.52   , market 1, product 3</code></pre><p>The column headings are variable names.  Each row corresponds to a (market, product) pair and both these columns are required, albeit that the columns can have different names; <em>market</em> and <em>product</em> are just the defaults.  The markets have especially boring names in this example, but any string goes.  The same is true for products.  This spreadsheet does <em>not</em> need to include the outside good (indeed, leave it out) and shares would thus typically sum to a number less than one.  Which columns are to be used and where is  determined by the <a href="../objects/#Grumps.Variables-Tuple{}"><code>Variables</code></a> call.  To use dummy variables, just insert a column with the corresponding characteristics (there can be multiple categories, which can be descriptive (e.g. strings)), which Grumps can turn into dummy variables automatically, as described in the <a href="../objects/#Grumps.Variables-Tuple{}"><code>Variables</code></a> documentation.</p><p>The <em>market</em> and <em>product</em> columns are required and <em>share</em> is required if the macro loglikelihood is to be included in the objective function.</p><h2 id="Consumer-characteristics"><a class="docs-heading-anchor" href="#Consumer-characteristics">Consumer characteristics</a><a id="Consumer-characteristics-1"></a><a class="docs-heading-anchor-permalink" href="#Consumer-characteristics" title="Permalink"></a></h2><p>Below are the first few lines of a CSV file.</p><pre><code class="nohighlight hljs">income,  age, market  ,     choice
 -1.20, 1.24, market 1,  product 8
 -0.64, 0.36, market 1, product 11
 -0.65, 1.32, market 1,  product 4
 -0.82, 0.77, market 1, product 11</code></pre><p>The column headings are again variable names.  Each row corresponds to a consumer in the observed micro sample. Here, we need both market and choice, but the columns do not have to have those (default) headings.  The markets and products could have had more descriptive names (e.g. &quot;Pennsylvania&quot; instead of &quot;market 1&quot;), and the column headings could have been different as long as the above linking conventions are followed. </p><p>In the consumer level spreadsheet, a consumer choice column and a market column are required and one should use at least one consumer characteristic to differentiate the micro likelihood from the macro likelihood.</p><h2 id="Market-sizes"><a class="docs-heading-anchor" href="#Market-sizes">Market sizes</a><a id="Market-sizes-1"></a><a class="docs-heading-anchor-permalink" href="#Market-sizes" title="Permalink"></a></h2><p>Below are the first few lines of a CSV file.</p><pre><code class="nohighlight hljs">N     , market
100000, market 1
100000, market 2
100000, market 3
100000, market 4
100000, market 5</code></pre><p>Each row corresponds to a market.  Again, the column headings can be adjusted and the ones presented here are the default ones.  Both columns are required.</p><h2 id="Draws"><a class="docs-heading-anchor" href="#Draws">Draws</a><a id="Draws-1"></a><a class="docs-heading-anchor-permalink" href="#Draws" title="Permalink"></a></h2><p>Below are the first few lines of a CSV file.</p><pre><code class="nohighlight hljs">income,  age, market
 -1.60, 1.19, market 1
 -2.93, 1.23, market 1
 -1.78, 1.58, market 1
 -1.14, 1.70, market 1</code></pre><p>The rows of this spreadsheet correspond to consumers in the population, albeit their choice need not be observed.  The format and limitations for the draws spreadsheets is essentially the same as the other spreadsheets, but here each line corresponds to a (draw,market) pair. For markets for which market size information is available, one typically needs a number of demographic draws no less than the number of Monte Carlo draws to be used, where each draw is a vector of demographic characteristics that would be observed in the micro sample.  </p><div class="admonition is-warning"><header class="admonition-header">Draws and default macro integrator options</header><div class="admonition-body"><p>Unless specified otherwise, the default macro integrator uses Monte Carlo integration with <span>$R = 10,000$</span> draws unless otherwise specified.  If one does not specify randomization then the default macro integrator simply uses the first <span>$R$</span> lines of draws for each market for demographics (<span>$z$</span> draws) and combines them with <span>$R$</span> draws from the distribution of the random coefficients (<span>$\nu$</span> draws), both of which are then interacted with the product level regressors (<span>$x$</span> variables).  If the spreadsheet does not contain enough rows corresponding to a market then the program will cycle and throw a warning.  With randomization with replacement, <span>$R$</span> numbers are drawn from the draws spreadsheet regardless of the number of lines in the spreadsheet.  Without replacement, the same occurs and if the spreadsheet does not contain enough lines corresponding to the market, all lines are added and then the procedure is repeated.  In other words, there is replacement by necessity.  Again, a warning will be displayed. With randomization, the random numbers are drawn separately for each market.</p></div></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../objects/">« User interface</a><a class="docs-footer-nextpage" href="../example/">Example program »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Wednesday 24 May 2023 01:40">Wednesday 24 May 2023</span>. Using Julia version 1.10.0-DEV.1363.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
